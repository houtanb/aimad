!
! Copyright (C) 2006-2014 Houtan Bastani and Luca Guerrieri
!
!
! This free software: you can redistribute it and/or modify
! it under the terms of the GNU General Public License as published by
! the Free Software Foundation, either version 3 of the License, or
! (at your option) any later version.
!
! It is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU General Public License for more details.
!
! You should have received a copy of the GNU General Public License
! along with Dynare.  If not, see <http://www.gnu.org/licenses/>.
!

!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.3 (r3163) - 09/25/2009 09:03
!
!  Differentiation of get_hmat in forward (tangent) mode: (multi-directional mode)
!   variations  of output variables: hmat
!   with respect to input variables: psi_array
SUBROUTINE GET_HMAT_DV(hmat, hmatd, hrows, hcols, psi_array, psi_arrayd&
&  , psin, nbdirs)
  USE DIFFSIZES
!  Hint: nbdirsmax should be the maximum number of differentiation directions
  IMPLICIT NONE
!
! Input Variables
!
  INTEGER, INTENT(IN) :: hrows, hcols, psin
  DOUBLE PRECISION, DIMENSION(psin), INTENT(IN) :: psi_array
  DOUBLE PRECISION, DIMENSION(nbdirsmax, psin), INTENT(IN) :: psi_arrayd
  DOUBLE PRECISION, DIMENSION(hrows, hcols), INTENT(OUT) :: hmat
  DOUBLE PRECISION, DIMENSION(nbdirsmax, hrows, hcols), INTENT(OUT) :: &
&  hmatd
!
! Local Variables
!
  DOUBLE PRECISION :: std_ea, std_eb
  DOUBLE PRECISION :: std_ead(nbdirsmax), std_ebd(nbdirsmax)
  DOUBLE PRECISION :: std_eg, std_eqs
  DOUBLE PRECISION :: std_egd(nbdirsmax), std_eqsd(nbdirsmax)
  DOUBLE PRECISION :: std_em, std_epinf
  DOUBLE PRECISION :: std_emd(nbdirsmax), std_epinfd(nbdirsmax)
  DOUBLE PRECISION :: std_ew, crhoa
  DOUBLE PRECISION :: std_ewd(nbdirsmax), crhoad(nbdirsmax)
  DOUBLE PRECISION :: crhob, crhog
  DOUBLE PRECISION :: crhobd(nbdirsmax), crhogd(nbdirsmax)
  DOUBLE PRECISION :: crhoqs, crhoms
  DOUBLE PRECISION :: crhoqsd(nbdirsmax), crhomsd(nbdirsmax)
  DOUBLE PRECISION :: crhopinf, crhow
  DOUBLE PRECISION :: crhopinfd(nbdirsmax), crhowd(nbdirsmax)
  DOUBLE PRECISION :: cmap, cmaw
  DOUBLE PRECISION :: cmapd(nbdirsmax), cmawd(nbdirsmax)
  DOUBLE PRECISION :: csadjcost, csigma
  DOUBLE PRECISION :: csadjcostd(nbdirsmax), csigmad(nbdirsmax)
  DOUBLE PRECISION :: chabb, cprobw
  DOUBLE PRECISION :: chabbd(nbdirsmax), cprobwd(nbdirsmax)
  DOUBLE PRECISION :: csigl, cprobp
  DOUBLE PRECISION :: csigld(nbdirsmax), cprobpd(nbdirsmax)
  DOUBLE PRECISION :: cindw, cindp
  DOUBLE PRECISION :: cindwd(nbdirsmax), cindpd(nbdirsmax)
  DOUBLE PRECISION :: czcap, cfc
  DOUBLE PRECISION :: czcapd(nbdirsmax), cfcd(nbdirsmax)
  DOUBLE PRECISION :: crpi, crr
  DOUBLE PRECISION :: crpid(nbdirsmax), crrd(nbdirsmax)
  DOUBLE PRECISION :: cry, crdy
  DOUBLE PRECISION :: cryd(nbdirsmax), crdyd(nbdirsmax)
  DOUBLE PRECISION :: constepinf, constebeta
  DOUBLE PRECISION :: constepinfd(nbdirsmax), constebetad(nbdirsmax)
  DOUBLE PRECISION :: constelab, ctrend
  DOUBLE PRECISION :: constelabd(nbdirsmax), ctrendd(nbdirsmax)
  DOUBLE PRECISION :: cgy, calfa
  DOUBLE PRECISION :: cgyd(nbdirsmax), calfad(nbdirsmax)
  DOUBLE PRECISION :: ctou, clandaw
  DOUBLE PRECISION :: cg, curvp
  DOUBLE PRECISION :: curvw, cpie
  DOUBLE PRECISION :: cgamma, cbeta
  DOUBLE PRECISION :: cgammad(nbdirsmax)
  DOUBLE PRECISION :: clandap, cbetabar
  DOUBLE PRECISION :: cbetabard(nbdirsmax)
  DOUBLE PRECISION :: cr, crk
  DOUBLE PRECISION :: crkd(nbdirsmax)
  DOUBLE PRECISION :: cw, cikbar
  DOUBLE PRECISION :: cikbard(nbdirsmax)
  DOUBLE PRECISION :: cik, clk
  DOUBLE PRECISION :: cky, ciy
  DOUBLE PRECISION :: ciyd(nbdirsmax)
  DOUBLE PRECISION :: ccy, crkky
  DOUBLE PRECISION :: ccyd(nbdirsmax), crkkyd(nbdirsmax)
  DOUBLE PRECISION :: cwhlc, cwly
  DOUBLE PRECISION :: cwhlcd(nbdirsmax)
  DOUBLE PRECISION :: conster
  DOUBLE PRECISION :: consterd(nbdirsmax)
  DOUBLE PRECISION :: pwx1
  DOUBLE PRECISION :: pwx1d(nbdirsmax)
  DOUBLE PRECISION :: pwy1
  DOUBLE PRECISION :: pwy1d(nbdirsmax)
  DOUBLE PRECISION :: pwr1
  DOUBLE PRECISION :: pwr1d(nbdirsmax)
  DOUBLE PRECISION :: pwx2
  DOUBLE PRECISION :: pwx2d(nbdirsmax)
  DOUBLE PRECISION :: pwy2
  DOUBLE PRECISION :: pwr2
  DOUBLE PRECISION :: pwr2d(nbdirsmax)
  DOUBLE PRECISION :: pwx3
  DOUBLE PRECISION :: pwx3d(nbdirsmax)
  DOUBLE PRECISION :: pwr3
  DOUBLE PRECISION :: pwr3d(nbdirsmax)
  DOUBLE PRECISION :: pwx4
  DOUBLE PRECISION :: pwx4d(nbdirsmax)
  DOUBLE PRECISION :: pwr4
  DOUBLE PRECISION :: pwr4d(nbdirsmax)
  DOUBLE PRECISION :: pwx5
  DOUBLE PRECISION :: pwx5d(nbdirsmax)
  DOUBLE PRECISION :: pwy5
  DOUBLE PRECISION :: pwy3
  DOUBLE PRECISION :: pwy3d(nbdirsmax)
  DOUBLE PRECISION :: pwr5
  DOUBLE PRECISION :: pwr5d(nbdirsmax)
  DOUBLE PRECISION :: pwx6
  DOUBLE PRECISION :: pwx6d(nbdirsmax)
  DOUBLE PRECISION :: pwy6
  DOUBLE PRECISION :: pwy6d(nbdirsmax)
  DOUBLE PRECISION :: pwr6
  DOUBLE PRECISION :: pwr6d(nbdirsmax)
  DOUBLE PRECISION :: pwx7
  DOUBLE PRECISION :: pwx7d(nbdirsmax)
  DOUBLE PRECISION :: pwy7
  DOUBLE PRECISION :: pwy7d(nbdirsmax)
  DOUBLE PRECISION :: pwr7
  DOUBLE PRECISION :: pwr7d(nbdirsmax)
  DOUBLE PRECISION :: pwy4
  DOUBLE PRECISION :: pwy4d(nbdirsmax)
  DOUBLE PRECISION :: pwx8
  DOUBLE PRECISION :: pwx8d(nbdirsmax)
  DOUBLE PRECISION :: pwy8
  DOUBLE PRECISION :: pwy8d(nbdirsmax)
  DOUBLE PRECISION :: pwr8
  DOUBLE PRECISION :: pwr8d(nbdirsmax)
  DOUBLE PRECISION :: pwx9
  DOUBLE PRECISION :: pwx9d(nbdirsmax)
  DOUBLE PRECISION :: pwr9
  DOUBLE PRECISION :: pwr9d(nbdirsmax)
  DOUBLE PRECISION :: pwr10
  DOUBLE PRECISION :: pwr10d(nbdirsmax)
  DOUBLE PRECISION :: pwx11
  DOUBLE PRECISION :: pwx11d(nbdirsmax)
  DOUBLE PRECISION :: pwy11
  DOUBLE PRECISION :: pwy11d(nbdirsmax)
  DOUBLE PRECISION :: pwr11
  DOUBLE PRECISION :: pwr11d(nbdirsmax)
  DOUBLE PRECISION :: pwx12
  DOUBLE PRECISION :: pwx12d(nbdirsmax)
  DOUBLE PRECISION :: pwr12
  DOUBLE PRECISION :: pwr12d(nbdirsmax)
  DOUBLE PRECISION :: pwx13
  DOUBLE PRECISION :: pwx13d(nbdirsmax)
  DOUBLE PRECISION :: pwr13
  DOUBLE PRECISION :: pwr13d(nbdirsmax)
  DOUBLE PRECISION :: pwx14
  DOUBLE PRECISION :: pwx14d(nbdirsmax)
  DOUBLE PRECISION :: pwy14
  DOUBLE PRECISION :: pwy14d(nbdirsmax)
  DOUBLE PRECISION :: pwr14
  DOUBLE PRECISION :: pwr14d(nbdirsmax)
  DOUBLE PRECISION :: pwx15
  DOUBLE PRECISION :: pwx15d(nbdirsmax)
  DOUBLE PRECISION :: pwy15
  DOUBLE PRECISION :: pwy15d(nbdirsmax)
  DOUBLE PRECISION :: pwr15
  DOUBLE PRECISION :: pwr15d(nbdirsmax)
  INTEGER :: nd
  INTEGER :: nbdirs
!
! Assign psi_array
!
  std_ea = psi_array(1)
  csigma = psi_array(18)
  chabb = psi_array(19)
  cprobw = psi_array(20)
  cindw = psi_array(23)
  cindp = psi_array(24)
  cfc = psi_array(26)
  constebeta = psi_array(32)
  ctrend = psi_array(34)
  cgy = psi_array(35)
  calfa = psi_array(36)
  clandaw = 1.5000000000000000d0
  curvw = 10.0000000000000000d0
  cgamma = 1 + ctrend/100
  pwx1 = 1 + ctrend/100
  pwy1 = -csigma
  pwr1 = pwx1**pwy1
  cbetabar = 1/(1+constebeta/100)*pwr1
  pwx9 = 1 + ctrend/100
  pwr9 = pwx9**csigma
  pwr10 = calfa**calfa
  pwx11 = 1 - calfa
  pwy11 = 1 - calfa
  pwr11 = pwx11**pwy11
  pwx12 = 1 + ctrend/100
  pwr12 = pwx12**csigma
  pwx13 = (1+constebeta/100)*pwr12 - 39.d0/40.d0
  pwr13 = pwx13**calfa
  pwx14 = pwr10*pwr11/cfc/pwr13
  pwy14 = 1/(1-calfa)
  pwr14 = pwx14**pwy14
  pwx15 = (1-calfa)/calfa*((1+constebeta/100)*pwr9-39.d0/40.d0)/pwr14
  pwy15 = -1 + calfa
  DO nd=1,nbdirs
    std_ead(nd) = psi_arrayd(nd, 1)
    std_ebd(nd) = psi_arrayd(nd, 2)
    std_egd(nd) = psi_arrayd(nd, 3)
    std_eqsd(nd) = psi_arrayd(nd, 4)
    std_emd(nd) = psi_arrayd(nd, 5)
    std_epinfd(nd) = psi_arrayd(nd, 6)
    std_ewd(nd) = psi_arrayd(nd, 7)
    crhoad(nd) = psi_arrayd(nd, 8)
    crhobd(nd) = psi_arrayd(nd, 9)
    crhogd(nd) = psi_arrayd(nd, 10)
    crhoqsd(nd) = psi_arrayd(nd, 11)
    crhomsd(nd) = psi_arrayd(nd, 12)
    crhopinfd(nd) = psi_arrayd(nd, 13)
    crhowd(nd) = psi_arrayd(nd, 14)
    cmapd(nd) = psi_arrayd(nd, 15)
    cmawd(nd) = psi_arrayd(nd, 16)
    csadjcostd(nd) = psi_arrayd(nd, 17)
    csigmad(nd) = psi_arrayd(nd, 18)
    chabbd(nd) = psi_arrayd(nd, 19)
    cprobwd(nd) = psi_arrayd(nd, 20)
    csigld(nd) = psi_arrayd(nd, 21)
    cprobpd(nd) = psi_arrayd(nd, 22)
    cindwd(nd) = psi_arrayd(nd, 23)
    cindpd(nd) = psi_arrayd(nd, 24)
    czcapd(nd) = psi_arrayd(nd, 25)
    cfcd(nd) = psi_arrayd(nd, 26)
    crpid(nd) = psi_arrayd(nd, 27)
    crrd(nd) = psi_arrayd(nd, 28)
    cryd(nd) = psi_arrayd(nd, 29)
    crdyd(nd) = psi_arrayd(nd, 30)
    constepinfd(nd) = psi_arrayd(nd, 31)
    constebetad(nd) = psi_arrayd(nd, 32)
    constelabd(nd) = psi_arrayd(nd, 33)
    ctrendd(nd) = psi_arrayd(nd, 34)
    cgyd(nd) = psi_arrayd(nd, 35)
    calfad(nd) = psi_arrayd(nd, 36)
    cgammad(nd) = ctrendd(nd)/100
    pwx1d(nd) = ctrendd(nd)/100
    pwy1d(nd) = -csigmad(nd)
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**pwy1*(LOG(pwx1)*pwy1d(nd)+pwy1*pwx1d(nd)/pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (pwy1 .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (pwy1 .EQ. INT(pwy1)) THEN
      pwr1d(nd) = pwy1*pwx1**(pwy1-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    cbetabard(nd) = pwr1d(nd)/(1+constebeta/100) - constebetad(nd)*pwr1/&
&      (100*(1+constebeta/100)**2)
    pwx1d(nd) = ctrendd(nd)/100
    cikbard(nd) = 39.d0*ctrendd(nd)/(40.d0*100)/(1+ctrend/100)**2
    IF (calfa .GT. 0.0) THEN
      pwr2d(nd) = calfa**calfa*(LOG(calfa)*calfad(nd)+calfa*calfad(nd)/&
&        calfa)
    ELSE IF (calfa .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr2d(nd) = calfad(nd)
      ELSE
        pwr2d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr2d(nd) = calfa*calfa**(calfa-1)*calfad(nd)
    ELSE
      pwr2d(nd) = 0.0
    END IF
    pwx3d(nd) = -calfad(nd)
    pwy3d(nd) = -calfad(nd)
    pwx4d(nd) = ctrendd(nd)/100
    pwy6d(nd) = calfad(nd)/(1-calfa)**2
    pwy7d(nd) = calfad(nd)
    pwx2d(nd) = ctrendd(nd)/100
    pwy4d(nd) = -calfad(nd)
    pwy8d(nd) = calfad(nd)
    pwx9d(nd) = ctrendd(nd)/100
    IF (pwx9 .GT. 0.0) THEN
      pwr9d(nd) = pwx9**csigma*(LOG(pwx9)*csigmad(nd)+csigma*pwx9d(nd)/&
&        pwx9)
    ELSE IF (pwx9 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr9d(nd) = pwx9d(nd)
      ELSE
        pwr9d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr9d(nd) = csigma*pwx9**(csigma-1)*pwx9d(nd)
    ELSE
      pwr9d(nd) = 0.0
    END IF
    IF (calfa .GT. 0.0) THEN
      pwr10d(nd) = calfa**calfa*(LOG(calfa)*calfad(nd)+calfa*calfad(nd)/&
&        calfa)
    ELSE IF (calfa .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr10d(nd) = calfad(nd)
      ELSE
        pwr10d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr10d(nd) = calfa*calfa**(calfa-1)*calfad(nd)
    ELSE
      pwr10d(nd) = 0.0
    END IF
    pwx11d(nd) = -calfad(nd)
    pwy11d(nd) = -calfad(nd)
    IF (pwx11 .GT. 0.0) THEN
      pwr11d(nd) = pwx11**pwy11*(LOG(pwx11)*pwy11d(nd)+pwy11*pwx11d(nd)/&
&        pwx11)
    ELSE IF (pwx11 .EQ. 0.0) THEN
      IF (pwy11 .EQ. 1.0) THEN
        pwr11d(nd) = pwx11d(nd)
      ELSE
        pwr11d(nd) = 0.0
      END IF
    ELSE IF (pwy11 .EQ. INT(pwy11)) THEN
      pwr11d(nd) = pwy11*pwx11**(pwy11-1)*pwx11d(nd)
    ELSE
      pwr11d(nd) = 0.0
    END IF
    pwx12d(nd) = ctrendd(nd)/100
    IF (pwx12 .GT. 0.0) THEN
      pwr12d(nd) = pwx12**csigma*(LOG(pwx12)*csigmad(nd)+csigma*pwx12d(&
&        nd)/pwx12)
    ELSE IF (pwx12 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr12d(nd) = pwx12d(nd)
      ELSE
        pwr12d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr12d(nd) = csigma*pwx12**(csigma-1)*pwx12d(nd)
    ELSE
      pwr12d(nd) = 0.0
    END IF
    pwx13d(nd) = constebetad(nd)*pwr12/100 + (1+constebeta/100)*pwr12d(&
&      nd)
    IF (pwx13 .GT. 0.0) THEN
      pwr13d(nd) = pwx13**calfa*(LOG(pwx13)*calfad(nd)+calfa*pwx13d(nd)/&
&        pwx13)
    ELSE IF (pwx13 .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr13d(nd) = pwx13d(nd)
      ELSE
        pwr13d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr13d(nd) = calfa*pwx13**(calfa-1)*pwx13d(nd)
    ELSE
      pwr13d(nd) = 0.0
    END IF
    pwx14d(nd) = (((pwr10d(nd)*pwr11+pwr10*pwr11d(nd))*cfc-pwr10*pwr11*&
&      cfcd(nd))*pwr13/cfc**2-pwr10*pwr11*pwr13d(nd)/cfc)/pwr13**2
    pwy14d(nd) = calfad(nd)/(1-calfa)**2
    IF (pwx14 .GT. 0.0) THEN
      pwr14d(nd) = pwx14**pwy14*(LOG(pwx14)*pwy14d(nd)+pwy14*pwx14d(nd)/&
&        pwx14)
    ELSE IF (pwx14 .EQ. 0.0) THEN
      IF (pwy14 .EQ. 1.0) THEN
        pwr14d(nd) = pwx14d(nd)
      ELSE
        pwr14d(nd) = 0.0
      END IF
    ELSE IF (pwy14 .EQ. INT(pwy14)) THEN
      pwr14d(nd) = pwy14*pwx14**(pwy14-1)*pwx14d(nd)
    ELSE
      pwr14d(nd) = 0.0
    END IF
    pwx15d(nd) = (((-(calfad(nd)*calfa)-(1-calfa)*calfad(nd))*((1+&
&      constebeta/100)*pwr9-39.d0/40.d0)/calfa**2+(1-calfa)*(constebetad(&
&      nd)*pwr9/100+(1+constebeta/100)*pwr9d(nd))/calfa)*pwr14-(1-calfa)*&
&      ((1+constebeta/100)*pwr9-39.d0/40.d0)*pwr14d(nd)/calfa)/pwr14**2
    pwy15d(nd) = calfad(nd)
    IF (pwx15 .GT. 0.0) THEN
      pwr15d(nd) = pwx15**pwy15*(LOG(pwx15)*pwy15d(nd)+pwy15*pwx15d(nd)/&
&        pwx15)
    ELSE IF (pwx15 .EQ. 0.0) THEN
      IF (pwy15 .EQ. 1.0) THEN
        pwr15d(nd) = pwx15d(nd)
      ELSE
        pwr15d(nd) = 0.0
      END IF
    ELSE IF (pwy15 .EQ. INT(pwy15)) THEN
      pwr15d(nd) = pwy15*pwx15**(pwy15-1)*pwx15d(nd)
    ELSE
      pwr15d(nd) = 0.0
    END IF
    pwy1d(nd) = -csigmad(nd)
    hmatd(nd, :, :) = 0.D0
    hmatd(nd, 5, 5) = -((-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))/(&
&      1+cbetabar*cgamma)**2)
    hmatd(nd, 7, 7) = -(((chabbd(nd)*cgamma-chabb*cgammad(nd))*(1+chabb/&
&      cgamma)/cgamma**2-chabb*(chabbd(nd)*cgamma-chabb*cgammad(nd))/&
&      cgamma**3)/(1+chabb/cgamma)**2)
    hmatd(nd, 10, 7) = ((chabbd(nd)*cgamma-chabb*cgammad(nd))*(1-chabb/&
&      cgamma)/cgamma**2+chabb*(chabbd(nd)*cgamma-chabb*cgammad(nd))/&
&      cgamma**3)/(1-chabb/cgamma)**2
    hmatd(nd, 23, 8) = -crdyd(nd)
    hmatd(nd, 4, 11) = 0.D0
    hmatd(nd, 11, 11) = cikbard(nd)
    hmatd(nd, 16, 16) = -((-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))&
&      /(1+cbetabar*cgamma)**2)
    hmatd(nd, 44, 16) = 0.D0
    hmatd(nd, 18, 18) = -(((chabbd(nd)*cgamma-chabb*cgammad(nd))*(1+&
&      chabb/cgamma)/cgamma**2-chabb*(chabbd(nd)*cgamma-chabb*cgammad(nd)&
&      )/cgamma**3)/(1+chabb/cgamma)**2)
    hmatd(nd, 22, 18) = ((((-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd)&
&      )*cprobw/(1+cbetabar*cgamma)**2)-cprobwd(nd)/(1+cbetabar*cgamma))*&
&      chabb/(cprobw**2*((clandaw-1)*curvw+1))+chabbd(nd)/((1+cbetabar*&
&      cgamma)*cprobw*((clandaw-1)*curvw+1)))*cgamma-chabb*cgammad(nd)/((&
&      1+cbetabar*cgamma)*cprobw*((clandaw-1)*curvw+1)))*(1-chabb/cgamma)&
&      /cgamma**2+chabb*(chabbd(nd)*cgamma-chabb*cgammad(nd))/((1+&
&      cbetabar*cgamma)*cprobw*((clandaw-1)*curvw+1)*cgamma**3))/(1-chabb&
&      /cgamma)**2 - (((cbetabard(nd)/(1+cbetabar*cgamma)-(cbetabard(nd)*&
&      cgamma+cbetabar*cgammad(nd))*cbetabar/(1+cbetabar*cgamma)**2)*&
&      chabb/((clandaw-1)*curvw+1)+cbetabar*chabbd(nd)/((1+cbetabar*&
&      cgamma)*((clandaw-1)*curvw+1)))*(1-chabb/cgamma)+cbetabar*chabb*(&
&      chabbd(nd)*cgamma-chabb*cgammad(nd))/((1+cbetabar*cgamma)*((&
&      clandaw-1)*curvw+1)*cgamma**2))/(1-chabb/cgamma)**2 - (((chabbd(nd&
&      )/((1+cbetabar*cgamma)*((clandaw-1)*curvw+1))-(cbetabard(nd)*&
&      cgamma+cbetabar*cgammad(nd))*chabb/((1+cbetabar*cgamma)**2*((&
&      clandaw-1)*curvw+1)))*cgamma-chabb*cgammad(nd)/((1+cbetabar*cgamma&
&      )*((clandaw-1)*curvw+1)))*(1-chabb/cgamma)/cgamma**2+chabb*(chabbd&
&      (nd)*cgamma-chabb*cgammad(nd))/((1+cbetabar*cgamma)*((clandaw-1)*&
&      curvw+1)*cgamma**3))/(1-chabb/cgamma)**2 + ((((cprobwd(nd)*&
&      cbetabar+cprobw*cbetabard(nd))*(1+cbetabar*cgamma)-cprobw*cbetabar&
&      *(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))*chabb/((1+cbetabar*&
&      cgamma)**2*((clandaw-1)*curvw+1))+cprobw*cbetabar*chabbd(nd)/((1+&
&      cbetabar*cgamma)*((clandaw-1)*curvw+1)))*(1-chabb/cgamma)+cprobw*&
&      cbetabar*chabb*(chabbd(nd)*cgamma-chabb*cgammad(nd))/((1+cbetabar*&
&      cgamma)*((clandaw-1)*curvw+1)*cgamma**2))/(1-chabb/cgamma)**2
    hmatd(nd, 43, 18) = 0.D0
    hmatd(nd, 23, 19) = crdyd(nd)
    hmatd(nd, 42, 19) = 0.D0
    hmatd(nd, 21, 21) = -(cindpd(nd)/(1+cbetabar*cgamma*cindp)-((&
&      cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*cindp+cbetabar*cgamma*&
&      cindpd(nd))*cindp/(1+cbetabar*cgamma*cindp)**2)
    hmatd(nd, 22, 21) = -((cindwd(nd)*(1+cbetabar*cgamma)-cindw*(&
&      cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))/(1+cbetabar*cgamma)**2&
&      )
    hmatd(nd, 22, 22) = -((-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))&
&      /(1+cbetabar*cgamma)**2)
    hmatd(nd, 45, 22) = 0.D0
    hmatd(nd, 23, 23) = -crrd(nd)
    hmatd(nd, 24, 24) = -crhoad(nd)
    hmatd(nd, 25, 25) = -crhobd(nd)
    hmatd(nd, 26, 26) = -crhogd(nd)
    hmatd(nd, 27, 27) = -crhoqsd(nd)
    hmatd(nd, 28, 28) = -crhomsd(nd)
    hmatd(nd, 29, 29) = -crhopinfd(nd)
    hmatd(nd, 29, 30) = cmapd(nd)
    hmatd(nd, 31, 31) = -crhowd(nd)
    hmatd(nd, 31, 32) = cmawd(nd)
    hmatd(nd, 24, 33) = -std_ead(nd)
    hmatd(nd, 26, 33) = -(cgyd(nd)*std_ea+cgy*std_ead(nd))
    hmatd(nd, 25, 34) = -std_ebd(nd)
    hmatd(nd, 26, 35) = -std_egd(nd)
    hmatd(nd, 27, 36) = -std_eqsd(nd)
    hmatd(nd, 28, 37) = -std_emd(nd)
    hmatd(nd, 30, 38) = -std_epinfd(nd)
    hmatd(nd, 32, 39) = -std_ewd(nd)
    hmatd(nd, 15, 40) = 0.D0
    hmatd(nd, 40, 40) = cikbard(nd)
    hmatd(nd, 41, 41) = 0.D0
    hmatd(nd, 6, 49) = 0.D0
    hmatd(nd, 7, 49) = (-(csigmad(nd)*(1+chabb/cgamma)/csigma**2)-(&
&      chabbd(nd)*cgamma-chabb*cgammad(nd))/(csigma*cgamma**2))/(1+chabb/&
&      cgamma)**2 - (((chabbd(nd)*cgamma-chabb*cgammad(nd))*csigma/cgamma&
&      **2-chabb*csigmad(nd)/cgamma)*(1+chabb/cgamma)/csigma**2-chabb*(&
&      chabbd(nd)*cgamma-chabb*cgammad(nd))/(cgamma**3*csigma))/(1+chabb/&
&      cgamma)**2
    hmatd(nd, 2, 50) = 0.D0
    hmatd(nd, 4, 50) = 0.D0
  END DO
  std_eb = psi_array(2)
  std_eg = psi_array(3)
  std_eqs = psi_array(4)
  std_em = psi_array(5)
  std_epinf = psi_array(6)
  std_ew = psi_array(7)
  crhoa = psi_array(8)
  crhob = psi_array(9)
  crhog = psi_array(10)
  crhoqs = psi_array(11)
  crhoms = psi_array(12)
  crhopinf = psi_array(13)
  crhow = psi_array(14)
  cmap = psi_array(15)
  cmaw = psi_array(16)
  csadjcost = psi_array(17)
  csigl = psi_array(21)
  cprobp = psi_array(22)
  czcap = psi_array(25)
  crpi = psi_array(27)
  crr = psi_array(28)
  cry = psi_array(29)
  crdy = psi_array(30)
  constepinf = psi_array(31)
  constelab = psi_array(33)
!
! Assign Composite Parameters
!
  ctou = 0.0250000000000000d0
  cg = 0.1800000000000000d0
  curvp = 10.0000000000000000d0
  cpie = 1 + constepinf/100
  cbeta = 1/(1+constebeta/100)
  clandap = cfc
  pwx1 = 1 + ctrend/100
  pwy1 = -csigma
  pwr1 = pwx1**pwy1
  cr = (1+constepinf/100)*(1+constebeta/100)/pwr1
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  DO nd=1,nbdirs
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**csigma*(LOG(pwx1)*csigmad(nd)+csigma*pwx1d(nd)/&
&        pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr1d(nd) = csigma*pwx1**(csigma-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    crkd(nd) = constebetad(nd)*pwr1/100 + (1+constebeta/100)*pwr1d(nd)
    pwx1d(nd) = ctrendd(nd)/100
  END DO
  crk = (1+constebeta/100)*pwr1 - 39.d0/40.d0
  pwr1 = calfa**calfa
  pwx2 = 1 - calfa
  pwy2 = 1 - calfa
  pwr2 = pwx2**pwy2
  pwx3 = 1 + ctrend/100
  pwr3 = pwx3**csigma
  pwx4 = (1+constebeta/100)*pwr3 - 39.d0/40.d0
  pwr4 = pwx4**calfa
  pwx5 = pwr1*pwr2/cfc/pwr4
  pwy5 = 1/(1-calfa)
  cw = pwx5**pwy5
  cikbar = 1 - 39.d0/40.d0/(1+ctrend/100)
  cik = (1-39.d0/40.d0/(1+ctrend/100))*(1+ctrend/100)
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwr2 = calfa**calfa
  pwx3 = 1 - calfa
  pwy3 = 1 - calfa
  pwr3 = pwx3**pwy3
  pwx4 = 1 + ctrend/100
  pwr4 = pwx4**csigma
  pwx5 = (1+constebeta/100)*pwr4 - 39.d0/40.d0
  pwr5 = pwx5**calfa
  pwx6 = pwr2*pwr3/cfc/pwr5
  pwy6 = 1/(1-calfa)
  pwr6 = pwx6**pwy6
  clk = (1-calfa)/calfa*((1+constebeta/100)*pwr1-39.d0/40.d0)/pwr6
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwr2 = calfa**calfa
  pwx3 = 1 - calfa
  pwy3 = 1 - calfa
  pwr3 = pwx3**pwy3
  pwx4 = 1 + ctrend/100
  pwr4 = pwx4**csigma
  pwx5 = (1+constebeta/100)*pwr4 - 39.d0/40.d0
  pwr5 = pwx5**calfa
  pwx6 = pwr2*pwr3/cfc/pwr5
  pwy6 = 1/(1-calfa)
  pwr6 = pwx6**pwy6
  pwx7 = (1-calfa)/calfa*((1+constebeta/100)*pwr1-39.d0/40.d0)/pwr6
  pwy7 = -1 + calfa
  pwr7 = pwx7**pwy7
  cky = cfc*pwr7
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwr2 = calfa**calfa
  pwx3 = 1 - calfa
  pwy3 = 1 - calfa
  pwr3 = pwx3**pwy3
  pwx4 = 1 + ctrend/100
  pwr4 = pwx4**csigma
  pwx5 = (1+constebeta/100)*pwr4 - 39.d0/40.d0
  pwr5 = pwx5**calfa
  pwx6 = pwr2*pwr3/cfc/pwr5
  pwy6 = 1/(1-calfa)
  pwr6 = pwx6**pwy6
  pwx7 = (1-calfa)/calfa*((1+constebeta/100)*pwr1-39.d0/40.d0)/pwr6
  pwy7 = -1 + calfa
  pwr7 = pwx7**pwy7
  DO nd=1,nbdirs
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**csigma*(LOG(pwx1)*csigmad(nd)+csigma*pwx1d(nd)/&
&        pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr1d(nd) = csigma*pwx1**(csigma-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    IF (pwx3 .GT. 0.0) THEN
      pwr3d(nd) = pwx3**pwy3*(LOG(pwx3)*pwy3d(nd)+pwy3*pwx3d(nd)/pwx3)
    ELSE IF (pwx3 .EQ. 0.0) THEN
      IF (pwy3 .EQ. 1.0) THEN
        pwr3d(nd) = pwx3d(nd)
      ELSE
        pwr3d(nd) = 0.0
      END IF
    ELSE IF (pwy3 .EQ. INT(pwy3)) THEN
      pwr3d(nd) = pwy3*pwx3**(pwy3-1)*pwx3d(nd)
    ELSE
      pwr3d(nd) = 0.0
    END IF
    IF (pwx4 .GT. 0.0) THEN
      pwr4d(nd) = pwx4**csigma*(LOG(pwx4)*csigmad(nd)+csigma*pwx4d(nd)/&
&        pwx4)
    ELSE IF (pwx4 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr4d(nd) = pwx4d(nd)
      ELSE
        pwr4d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr4d(nd) = csigma*pwx4**(csigma-1)*pwx4d(nd)
    ELSE
      pwr4d(nd) = 0.0
    END IF
    pwx5d(nd) = constebetad(nd)*pwr4/100 + (1+constebeta/100)*pwr4d(nd)
    IF (pwx5 .GT. 0.0) THEN
      pwr5d(nd) = pwx5**calfa*(LOG(pwx5)*calfad(nd)+calfa*pwx5d(nd)/pwx5&
&        )
    ELSE IF (pwx5 .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr5d(nd) = pwx5d(nd)
      ELSE
        pwr5d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr5d(nd) = calfa*pwx5**(calfa-1)*pwx5d(nd)
    ELSE
      pwr5d(nd) = 0.0
    END IF
    pwx6d(nd) = (((pwr2d(nd)*pwr3+pwr2*pwr3d(nd))*cfc-pwr2*pwr3*cfcd(nd)&
&      )*pwr5/cfc**2-pwr2*pwr3*pwr5d(nd)/cfc)/pwr5**2
    IF (pwx6 .GT. 0.0) THEN
      pwr6d(nd) = pwx6**pwy6*(LOG(pwx6)*pwy6d(nd)+pwy6*pwx6d(nd)/pwx6)
    ELSE IF (pwx6 .EQ. 0.0) THEN
      IF (pwy6 .EQ. 1.0) THEN
        pwr6d(nd) = pwx6d(nd)
      ELSE
        pwr6d(nd) = 0.0
      END IF
    ELSE IF (pwy6 .EQ. INT(pwy6)) THEN
      pwr6d(nd) = pwy6*pwx6**(pwy6-1)*pwx6d(nd)
    ELSE
      pwr6d(nd) = 0.0
    END IF
    pwx7d(nd) = (((-(calfad(nd)*calfa)-(1-calfa)*calfad(nd))*((1+&
&      constebeta/100)*pwr1-39.d0/40.d0)/calfa**2+(1-calfa)*(constebetad(&
&      nd)*pwr1/100+(1+constebeta/100)*pwr1d(nd))/calfa)*pwr6-(1-calfa)*(&
&      (1+constebeta/100)*pwr1-39.d0/40.d0)*pwr6d(nd)/calfa)/pwr6**2
    IF (pwx7 .GT. 0.0) THEN
      pwr7d(nd) = pwx7**pwy7*(LOG(pwx7)*pwy7d(nd)+pwy7*pwx7d(nd)/pwx7)
    ELSE IF (pwx7 .EQ. 0.0) THEN
      IF (pwy7 .EQ. 1.0) THEN
        pwr7d(nd) = pwx7d(nd)
      ELSE
        pwr7d(nd) = 0.0
      END IF
    ELSE IF (pwy7 .EQ. INT(pwy7)) THEN
      pwr7d(nd) = pwy7*pwx7**(pwy7-1)*pwx7d(nd)
    ELSE
      pwr7d(nd) = 0.0
    END IF
    ciyd(nd) = 39.d0*ctrendd(nd)*cfc*pwr7/(40.d0*100*(1+ctrend/100)) + (&
&      1-39.d0/40.d0/(1+ctrend/100))*(ctrendd(nd)*cfc*pwr7/100+(1+ctrend/&
&      100)*(cfcd(nd)*pwr7+cfc*pwr7d(nd)))
    pwx1d(nd) = ctrendd(nd)/100
    IF (calfa .GT. 0.0) THEN
      pwr2d(nd) = calfa**calfa*(LOG(calfa)*calfad(nd)+calfa*calfad(nd)/&
&        calfa)
    ELSE IF (calfa .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr2d(nd) = calfad(nd)
      ELSE
        pwr2d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr2d(nd) = calfa*calfa**(calfa-1)*calfad(nd)
    ELSE
      pwr2d(nd) = 0.0
    END IF
    pwx3d(nd) = -calfad(nd)
    pwy3d(nd) = -calfad(nd)
    pwx4d(nd) = ctrendd(nd)/100
    pwy6d(nd) = calfad(nd)/(1-calfa)**2
    pwy7d(nd) = calfad(nd)
  END DO
  ciy = (1-39.d0/40.d0/(1+ctrend/100))*(1+ctrend/100)*cfc*pwr7
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwr2 = calfa**calfa
  pwx3 = 1 - calfa
  pwy3 = 1 - calfa
  pwr3 = pwx3**pwy3
  pwx4 = 1 + ctrend/100
  pwr4 = pwx4**csigma
  pwx5 = (1+constebeta/100)*pwr4 - 39.d0/40.d0
  pwr5 = pwx5**calfa
  pwx6 = pwr2*pwr3/cfc/pwr5
  pwy6 = 1/(1-calfa)
  pwr6 = pwx6**pwy6
  pwx7 = (1-calfa)/calfa*((1+constebeta/100)*pwr1-39.d0/40.d0)/pwr6
  pwy7 = -1 + calfa
  pwr7 = pwx7**pwy7
  pwx2 = 1 + ctrend/100
  DO nd=1,nbdirs
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**csigma*(LOG(pwx1)*csigmad(nd)+csigma*pwx1d(nd)/&
&        pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr1d(nd) = csigma*pwx1**(csigma-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    IF (pwx3 .GT. 0.0) THEN
      pwr3d(nd) = pwx3**pwy3*(LOG(pwx3)*pwy3d(nd)+pwy3*pwx3d(nd)/pwx3)
    ELSE IF (pwx3 .EQ. 0.0) THEN
      IF (pwy3 .EQ. 1.0) THEN
        pwr3d(nd) = pwx3d(nd)
      ELSE
        pwr3d(nd) = 0.0
      END IF
    ELSE IF (pwy3 .EQ. INT(pwy3)) THEN
      pwr3d(nd) = pwy3*pwx3**(pwy3-1)*pwx3d(nd)
    ELSE
      pwr3d(nd) = 0.0
    END IF
    IF (pwx4 .GT. 0.0) THEN
      pwr4d(nd) = pwx4**csigma*(LOG(pwx4)*csigmad(nd)+csigma*pwx4d(nd)/&
&        pwx4)
    ELSE IF (pwx4 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr4d(nd) = pwx4d(nd)
      ELSE
        pwr4d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr4d(nd) = csigma*pwx4**(csigma-1)*pwx4d(nd)
    ELSE
      pwr4d(nd) = 0.0
    END IF
    pwx5d(nd) = constebetad(nd)*pwr4/100 + (1+constebeta/100)*pwr4d(nd)
    IF (pwx5 .GT. 0.0) THEN
      pwr5d(nd) = pwx5**calfa*(LOG(pwx5)*calfad(nd)+calfa*pwx5d(nd)/pwx5&
&        )
    ELSE IF (pwx5 .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr5d(nd) = pwx5d(nd)
      ELSE
        pwr5d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr5d(nd) = calfa*pwx5**(calfa-1)*pwx5d(nd)
    ELSE
      pwr5d(nd) = 0.0
    END IF
    pwx6d(nd) = (((pwr2d(nd)*pwr3+pwr2*pwr3d(nd))*cfc-pwr2*pwr3*cfcd(nd)&
&      )*pwr5/cfc**2-pwr2*pwr3*pwr5d(nd)/cfc)/pwr5**2
    IF (pwx6 .GT. 0.0) THEN
      pwr6d(nd) = pwx6**pwy6*(LOG(pwx6)*pwy6d(nd)+pwy6*pwx6d(nd)/pwx6)
    ELSE IF (pwx6 .EQ. 0.0) THEN
      IF (pwy6 .EQ. 1.0) THEN
        pwr6d(nd) = pwx6d(nd)
      ELSE
        pwr6d(nd) = 0.0
      END IF
    ELSE IF (pwy6 .EQ. INT(pwy6)) THEN
      pwr6d(nd) = pwy6*pwx6**(pwy6-1)*pwx6d(nd)
    ELSE
      pwr6d(nd) = 0.0
    END IF
    pwx7d(nd) = (((-(calfad(nd)*calfa)-(1-calfa)*calfad(nd))*((1+&
&      constebeta/100)*pwr1-39.d0/40.d0)/calfa**2+(1-calfa)*(constebetad(&
&      nd)*pwr1/100+(1+constebeta/100)*pwr1d(nd))/calfa)*pwr6-(1-calfa)*(&
&      (1+constebeta/100)*pwr1-39.d0/40.d0)*pwr6d(nd)/calfa)/pwr6**2
    IF (pwx7 .GT. 0.0) THEN
      pwr7d(nd) = pwx7**pwy7*(LOG(pwx7)*pwy7d(nd)+pwy7*pwx7d(nd)/pwx7)
    ELSE IF (pwx7 .EQ. 0.0) THEN
      IF (pwy7 .EQ. 1.0) THEN
        pwr7d(nd) = pwx7d(nd)
      ELSE
        pwr7d(nd) = 0.0
      END IF
    ELSE IF (pwy7 .EQ. INT(pwy7)) THEN
      pwr7d(nd) = pwy7*pwx7**(pwy7-1)*pwx7d(nd)
    ELSE
      pwr7d(nd) = 0.0
    END IF
    ccyd(nd) = -(39.d0*ctrendd(nd)*cfc*pwr7/(40.d0*100*(1+ctrend/100))) &
&      - (1-39.d0/40.d0/(1+ctrend/100))*(ctrendd(nd)*cfc*pwr7/100+(1+&
&      ctrend/100)*(cfcd(nd)*pwr7+cfc*pwr7d(nd)))
    pwx1d(nd) = ctrendd(nd)/100
    IF (pwx2 .GT. 0.0) THEN
      pwr2d(nd) = pwx2**csigma*(LOG(pwx2)*csigmad(nd)+csigma*pwx2d(nd)/&
&        pwx2)
    ELSE IF (pwx2 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr2d(nd) = pwx2d(nd)
      ELSE
        pwr2d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr2d(nd) = csigma*pwx2**(csigma-1)*pwx2d(nd)
    ELSE
      pwr2d(nd) = 0.0
    END IF
    IF (calfa .GT. 0.0) THEN
      pwr3d(nd) = calfa**calfa*(LOG(calfa)*calfad(nd)+calfa*calfad(nd)/&
&        calfa)
    ELSE IF (calfa .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr3d(nd) = calfad(nd)
      ELSE
        pwr3d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr3d(nd) = calfa*calfa**(calfa-1)*calfad(nd)
    ELSE
      pwr3d(nd) = 0.0
    END IF
    pwx4d(nd) = -calfad(nd)
    pwx5d(nd) = ctrendd(nd)/100
    pwy7d(nd) = calfad(nd)/(1-calfa)**2
    pwx2d(nd) = ctrendd(nd)/100
  END DO
  ccy = 41.d0/50.d0 - (1-39.d0/40.d0/(1+ctrend/100))*(1+ctrend/100)*cfc*&
&    pwr7
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwr2 = pwx2**csigma
  pwr3 = calfa**calfa
  pwx4 = 1 - calfa
  pwy4 = 1 - calfa
  pwr4 = pwx4**pwy4
  pwx5 = 1 + ctrend/100
  pwr5 = pwx5**csigma
  pwx6 = (1+constebeta/100)*pwr5 - 39.d0/40.d0
  pwr6 = pwx6**calfa
  pwx7 = pwr3*pwr4/cfc/pwr6
  pwy7 = 1/(1-calfa)
  pwr7 = pwx7**pwy7
  pwx8 = (1-calfa)/calfa*((1+constebeta/100)*pwr2-39.d0/40.d0)/pwr7
  pwy8 = -1 + calfa
  pwr8 = pwx8**pwy8
  pwx2 = 1 + ctrend/100
  DO nd=1,nbdirs
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**csigma*(LOG(pwx1)*csigmad(nd)+csigma*pwx1d(nd)/&
&        pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr1d(nd) = csigma*pwx1**(csigma-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    IF (pwx4 .GT. 0.0) THEN
      pwr4d(nd) = pwx4**pwy4*(LOG(pwx4)*pwy4d(nd)+pwy4*pwx4d(nd)/pwx4)
    ELSE IF (pwx4 .EQ. 0.0) THEN
      IF (pwy4 .EQ. 1.0) THEN
        pwr4d(nd) = pwx4d(nd)
      ELSE
        pwr4d(nd) = 0.0
      END IF
    ELSE IF (pwy4 .EQ. INT(pwy4)) THEN
      pwr4d(nd) = pwy4*pwx4**(pwy4-1)*pwx4d(nd)
    ELSE
      pwr4d(nd) = 0.0
    END IF
    IF (pwx5 .GT. 0.0) THEN
      pwr5d(nd) = pwx5**csigma*(LOG(pwx5)*csigmad(nd)+csigma*pwx5d(nd)/&
&        pwx5)
    ELSE IF (pwx5 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr5d(nd) = pwx5d(nd)
      ELSE
        pwr5d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr5d(nd) = csigma*pwx5**(csigma-1)*pwx5d(nd)
    ELSE
      pwr5d(nd) = 0.0
    END IF
    pwx6d(nd) = constebetad(nd)*pwr5/100 + (1+constebeta/100)*pwr5d(nd)
    IF (pwx6 .GT. 0.0) THEN
      pwr6d(nd) = pwx6**calfa*(LOG(pwx6)*calfad(nd)+calfa*pwx6d(nd)/pwx6&
&        )
    ELSE IF (pwx6 .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr6d(nd) = pwx6d(nd)
      ELSE
        pwr6d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr6d(nd) = calfa*pwx6**(calfa-1)*pwx6d(nd)
    ELSE
      pwr6d(nd) = 0.0
    END IF
    pwx7d(nd) = (((pwr3d(nd)*pwr4+pwr3*pwr4d(nd))*cfc-pwr3*pwr4*cfcd(nd)&
&      )*pwr6/cfc**2-pwr3*pwr4*pwr6d(nd)/cfc)/pwr6**2
    IF (pwx7 .GT. 0.0) THEN
      pwr7d(nd) = pwx7**pwy7*(LOG(pwx7)*pwy7d(nd)+pwy7*pwx7d(nd)/pwx7)
    ELSE IF (pwx7 .EQ. 0.0) THEN
      IF (pwy7 .EQ. 1.0) THEN
        pwr7d(nd) = pwx7d(nd)
      ELSE
        pwr7d(nd) = 0.0
      END IF
    ELSE IF (pwy7 .EQ. INT(pwy7)) THEN
      pwr7d(nd) = pwy7*pwx7**(pwy7-1)*pwx7d(nd)
    ELSE
      pwr7d(nd) = 0.0
    END IF
    pwx8d(nd) = (((-(calfad(nd)*calfa)-(1-calfa)*calfad(nd))*((1+&
&      constebeta/100)*pwr2-39.d0/40.d0)/calfa**2+(1-calfa)*(constebetad(&
&      nd)*pwr2/100+(1+constebeta/100)*pwr2d(nd))/calfa)*pwr7-(1-calfa)*(&
&      (1+constebeta/100)*pwr2-39.d0/40.d0)*pwr7d(nd)/calfa)/pwr7**2
    IF (pwx8 .GT. 0.0) THEN
      pwr8d(nd) = pwx8**pwy8*(LOG(pwx8)*pwy8d(nd)+pwy8*pwx8d(nd)/pwx8)
    ELSE IF (pwx8 .EQ. 0.0) THEN
      IF (pwy8 .EQ. 1.0) THEN
        pwr8d(nd) = pwx8d(nd)
      ELSE
        pwr8d(nd) = 0.0
      END IF
    ELSE IF (pwy8 .EQ. INT(pwy8)) THEN
      pwr8d(nd) = pwy8*pwx8**(pwy8-1)*pwx8d(nd)
    ELSE
      pwr8d(nd) = 0.0
    END IF
    crkkyd(nd) = (constebetad(nd)*pwr1/100+(1+constebeta/100)*pwr1d(nd))&
&      *cfc*pwr8 + ((1+constebeta/100)*pwr1-39.d0/40.d0)*(cfcd(nd)*pwr8+&
&      cfc*pwr8d(nd))
    pwx1d(nd) = ctrendd(nd)/100
    IF (pwx2 .GT. 0.0) THEN
      pwr2d(nd) = pwx2**csigma*(LOG(pwx2)*csigmad(nd)+csigma*pwx2d(nd)/&
&        pwx2)
    ELSE IF (pwx2 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr2d(nd) = pwx2d(nd)
      ELSE
        pwr2d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr2d(nd) = csigma*pwx2**(csigma-1)*pwx2d(nd)
    ELSE
      pwr2d(nd) = 0.0
    END IF
    IF (calfa .GT. 0.0) THEN
      pwr3d(nd) = calfa**calfa*(LOG(calfa)*calfad(nd)+calfa*calfad(nd)/&
&        calfa)
    ELSE IF (calfa .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr3d(nd) = calfad(nd)
      ELSE
        pwr3d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr3d(nd) = calfa*calfa**(calfa-1)*calfad(nd)
    ELSE
      pwr3d(nd) = 0.0
    END IF
    pwx4d(nd) = -calfad(nd)
    pwy4d(nd) = -calfad(nd)
    pwx5d(nd) = ctrendd(nd)/100
    pwy7d(nd) = calfad(nd)/(1-calfa)**2
    pwy8d(nd) = calfad(nd)
    hmatd(nd, 8, 50) = -crkkyd(nd)
    hmatd(nd, 1, 51) = -calfad(nd)
    hmatd(nd, 2, 51) = -(-(czcapd(nd)*(1-czcap)/czcap**2)-czcapd(nd)/&
&      czcap)
    hmatd(nd, 3, 51) = 0.D0
    hmatd(nd, 3, 52) = 0.D0
    hmatd(nd, 4, 52) = 0.D0
    hmatd(nd, 9, 52) = -(cfcd(nd)*calfa+cfc*calfad(nd))
    hmatd(nd, 5, 53) = 0.D0
    hmatd(nd, 8, 53) = -ciyd(nd)
    hmatd(nd, 11, 53) = -cikbard(nd)
    hmatd(nd, 5, 54) = -(((-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))&
&      *cgamma**2/(1+cbetabar*cgamma)**2)-2*cgamma*cgammad(nd)/(1+&
&      cbetabar*cgamma))*csadjcost/cgamma**4-csadjcostd(nd)/((1+cbetabar*&
&      cgamma)*cgamma**2))/csadjcost**2)
    hmatd(nd, 6, 54) = 0.D0
    hmatd(nd, 7, 55) = 0.D0
    hmatd(nd, 8, 55) = -ccyd(nd)
    hmatd(nd, 10, 55) = -((chabbd(nd)*cgamma-chabb*cgammad(nd))/cgamma**&
&      2/(1-chabb/cgamma)**2)
    hmatd(nd, 8, 56) = 0.D0
    hmatd(nd, 9, 56) = 0.D0
    hmatd(nd, 23, 56) = cryd(nd) - cryd(nd)*crr - cry*crrd(nd) + crdyd(&
&      nd)
    hmatd(nd, 3, 57) = 0.D0
  END DO
  crkky = ((1+constebeta/100)*pwr1-39.d0/40.d0)*cfc*pwr8
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwr2 = pwx2**csigma
  pwr3 = calfa**calfa
  pwx4 = 1 - calfa
  pwy4 = 1 - calfa
  pwr4 = pwx4**pwy4
  pwx5 = 1 + ctrend/100
  pwr5 = pwx5**csigma
  pwx6 = (1+constebeta/100)*pwr5 - 39.d0/40.d0
  pwr6 = pwx6**calfa
  pwx7 = pwr3*pwr4/cfc/pwr6
  pwy7 = 1/(1-calfa)
  pwr7 = pwx7**pwy7
  pwx8 = (1-calfa)/calfa*((1+constebeta/100)*pwr2-39.d0/40.d0)/pwr7
  pwy8 = -1 + calfa
  pwr8 = pwx8**pwy8
  pwr15 = pwx15**pwy15
  cwhlc = (2.d0/3.d0-2.d0/3.d0*calfa)/calfa*((1+constebeta/100)*pwr1-&
&    39.d0/40.d0)*cfc*pwr8/(41.d0/50.d0-(1-39.d0/40.d0/(1+ctrend/100))*(1&
&    +ctrend/100)*cfc*pwr15)
  DO nd=1,nbdirs
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**csigma*(LOG(pwx1)*csigmad(nd)+csigma*pwx1d(nd)/&
&        pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr1d(nd) = csigma*pwx1**(csigma-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    IF (pwx4 .GT. 0.0) THEN
      pwr4d(nd) = pwx4**pwy4*(LOG(pwx4)*pwy4d(nd)+pwy4*pwx4d(nd)/pwx4)
    ELSE IF (pwx4 .EQ. 0.0) THEN
      IF (pwy4 .EQ. 1.0) THEN
        pwr4d(nd) = pwx4d(nd)
      ELSE
        pwr4d(nd) = 0.0
      END IF
    ELSE IF (pwy4 .EQ. INT(pwy4)) THEN
      pwr4d(nd) = pwy4*pwx4**(pwy4-1)*pwx4d(nd)
    ELSE
      pwr4d(nd) = 0.0
    END IF
    IF (pwx5 .GT. 0.0) THEN
      pwr5d(nd) = pwx5**csigma*(LOG(pwx5)*csigmad(nd)+csigma*pwx5d(nd)/&
&        pwx5)
    ELSE IF (pwx5 .EQ. 0.0) THEN
      IF (csigma .EQ. 1.0) THEN
        pwr5d(nd) = pwx5d(nd)
      ELSE
        pwr5d(nd) = 0.0
      END IF
    ELSE IF (csigma .EQ. INT(csigma)) THEN
      pwr5d(nd) = csigma*pwx5**(csigma-1)*pwx5d(nd)
    ELSE
      pwr5d(nd) = 0.0
    END IF
    pwx6d(nd) = constebetad(nd)*pwr5/100 + (1+constebeta/100)*pwr5d(nd)
    IF (pwx6 .GT. 0.0) THEN
      pwr6d(nd) = pwx6**calfa*(LOG(pwx6)*calfad(nd)+calfa*pwx6d(nd)/pwx6&
&        )
    ELSE IF (pwx6 .EQ. 0.0) THEN
      IF (calfa .EQ. 1.0) THEN
        pwr6d(nd) = pwx6d(nd)
      ELSE
        pwr6d(nd) = 0.0
      END IF
    ELSE IF (calfa .EQ. INT(calfa)) THEN
      pwr6d(nd) = calfa*pwx6**(calfa-1)*pwx6d(nd)
    ELSE
      pwr6d(nd) = 0.0
    END IF
    pwx7d(nd) = (((pwr3d(nd)*pwr4+pwr3*pwr4d(nd))*cfc-pwr3*pwr4*cfcd(nd)&
&      )*pwr6/cfc**2-pwr3*pwr4*pwr6d(nd)/cfc)/pwr6**2
    IF (pwx7 .GT. 0.0) THEN
      pwr7d(nd) = pwx7**pwy7*(LOG(pwx7)*pwy7d(nd)+pwy7*pwx7d(nd)/pwx7)
    ELSE IF (pwx7 .EQ. 0.0) THEN
      IF (pwy7 .EQ. 1.0) THEN
        pwr7d(nd) = pwx7d(nd)
      ELSE
        pwr7d(nd) = 0.0
      END IF
    ELSE IF (pwy7 .EQ. INT(pwy7)) THEN
      pwr7d(nd) = pwy7*pwx7**(pwy7-1)*pwx7d(nd)
    ELSE
      pwr7d(nd) = 0.0
    END IF
    pwx8d(nd) = (((-(calfad(nd)*calfa)-(1-calfa)*calfad(nd))*((1+&
&      constebeta/100)*pwr2-39.d0/40.d0)/calfa**2+(1-calfa)*(constebetad(&
&      nd)*pwr2/100+(1+constebeta/100)*pwr2d(nd))/calfa)*pwr7-(1-calfa)*(&
&      (1+constebeta/100)*pwr2-39.d0/40.d0)*pwr7d(nd)/calfa)/pwr7**2
    IF (pwx8 .GT. 0.0) THEN
      pwr8d(nd) = pwx8**pwy8*(LOG(pwx8)*pwy8d(nd)+pwy8*pwx8d(nd)/pwx8)
    ELSE IF (pwx8 .EQ. 0.0) THEN
      IF (pwy8 .EQ. 1.0) THEN
        pwr8d(nd) = pwx8d(nd)
      ELSE
        pwr8d(nd) = 0.0
      END IF
    ELSE IF (pwy8 .EQ. INT(pwy8)) THEN
      pwr8d(nd) = pwy8*pwx8**(pwy8-1)*pwx8d(nd)
    ELSE
      pwr8d(nd) = 0.0
    END IF
    cwhlcd(nd) = (((-(2.d0*calfad(nd)*calfa/3.d0)-(2.d0/3.d0-2.d0/3.d0*&
&      calfa)*calfad(nd))*((1+constebeta/100)*pwr1-39.d0/40.d0)*cfc*pwr8/&
&      calfa**2+(2.d0/3.d0-2.d0/3.d0*calfa)*((constebetad(nd)*pwr1/100+(1&
&      +constebeta/100)*pwr1d(nd))*cfc*pwr8+((1+constebeta/100)*pwr1-&
&      39.d0/40.d0)*(cfcd(nd)*pwr8+cfc*pwr8d(nd)))/calfa)*(41.d0/50.d0-(1&
&      -39.d0/40.d0/(1+ctrend/100))*(1+ctrend/100)*cfc*pwr15)-(2.d0/3.d0-&
&      2.d0/3.d0*calfa)*((1+constebeta/100)*pwr1-39.d0/40.d0)*cfc*pwr8*(-&
&      (39.d0*ctrendd(nd)*cfc*pwr15/(40.d0*100*(1+ctrend/100)))-(1-39.d0/&
&      40.d0/(1+ctrend/100))*(ctrendd(nd)*cfc*pwr15/100+(1+ctrend/100)*(&
&      cfcd(nd)*pwr15+cfc*pwr15d(nd))))/calfa)/(41.d0/50.d0-(1-39.d0/&
&      40.d0/(1+ctrend/100))*(1+ctrend/100)*cfc*pwr15)**2
    pwx1d(nd) = ctrendd(nd)/100
    hmatd(nd, 7, 57) = ((cwhlcd(nd)*csigma-cwhlc*csigmad(nd))*(1+chabb/&
&      cgamma)/csigma**2-cwhlc*(chabbd(nd)*cgamma-chabb*cgammad(nd))/(&
&      csigma*cgamma**2))/(1+chabb/cgamma)**2 - (cwhlcd(nd)*(1+chabb/&
&      cgamma)-cwhlc*(chabbd(nd)*cgamma-chabb*cgammad(nd))/cgamma**2)/(1+&
&      chabb/cgamma)**2
    hmatd(nd, 9, 57) = cfcd(nd)*calfa - cfcd(nd) + cfc*calfad(nd)
    hmatd(nd, 10, 57) = -csigld(nd)
    hmatd(nd, 1, 58) = calfad(nd)
    hmatd(nd, 3, 58) = 0.D0
    hmatd(nd, 10, 58) = 0.D0
    hmatd(nd, 11, 59) = 0.D0
    hmatd(nd, 12, 60) = 0.D0
    hmatd(nd, 21, 60) = (((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(1&
&      +cbetabar*cgamma*cindp)-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd&
&      ))*cindp+cbetabar*cgamma*cindpd(nd))*cbetabar*cgamma/(1+cbetabar*&
&      cgamma*cindp)**2)*((cfc-1)*curvp+1)-cbetabar*cgamma*curvp*cfcd(nd)&
&      /(1+cbetabar*cgamma*cindp))/((cfc-1)*curvp+1)**2 - ((-(((cbetabard&
&      (nd)*cgamma+cbetabar*cgammad(nd))*cindp+cbetabar*cgamma*cindpd(nd)&
&      )*cprobp/(1+cbetabar*cgamma*cindp)**2)-cprobpd(nd)/(1+cbetabar*&
&      cgamma*cindp))*((cfc-1)*curvp+1)/cprobp**2-curvp*cfcd(nd)/((1+&
&      cbetabar*cgamma*cindp)*cprobp))/((cfc-1)*curvp+1)**2 + (-(((&
&      cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*cindp+cbetabar*cgamma*&
&      cindpd(nd))*((cfc-1)*curvp+1)/(1+cbetabar*cgamma*cindp)**2)-curvp*&
&      cfcd(nd)/(1+cbetabar*cgamma*cindp))/((cfc-1)*curvp+1)**2 - ((((&
&      cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*cprobp+cbetabar*cgamma*&
&      cprobpd(nd))/(1+cbetabar*cgamma*cindp)-((cbetabard(nd)*cgamma+&
&      cbetabar*cgammad(nd))*cindp+cbetabar*cgamma*cindpd(nd))*cbetabar*&
&      cgamma*cprobp/(1+cbetabar*cgamma*cindp)**2)*((cfc-1)*curvp+1)-&
&      cbetabar*cgamma*cprobp*curvp*cfcd(nd)/(1+cbetabar*cgamma*cindp))/(&
&      (cfc-1)*curvp+1)**2
    hmatd(nd, 13, 61) = 0.D0
    hmatd(nd, 15, 61) = 0.D0
    hmatd(nd, 19, 61) = -crkkyd(nd)
    hmatd(nd, 12, 62) = -calfad(nd)
    hmatd(nd, 13, 62) = -(-(czcapd(nd)*(1-czcap)/czcap**2)-czcapd(nd)/&
&      czcap)
    hmatd(nd, 14, 62) = 0.D0
    hmatd(nd, 14, 63) = 0.D0
    hmatd(nd, 15, 63) = 0.D0
    hmatd(nd, 20, 63) = -(cfcd(nd)*calfa+cfc*calfad(nd))
    hmatd(nd, 16, 64) = 0.D0
    hmatd(nd, 19, 64) = -ciyd(nd)
    hmatd(nd, 40, 64) = -cikbard(nd)
    hmatd(nd, 44, 64) = 0.D0
    hmatd(nd, 16, 65) = -(((-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd)&
&      )*cgamma**2/(1+cbetabar*cgamma)**2)-2*cgamma*cgammad(nd)/(1+&
&      cbetabar*cgamma))*csadjcost/cgamma**4-csadjcostd(nd)/((1+cbetabar*&
&      cgamma)*cgamma**2))/csadjcost**2)
    hmatd(nd, 17, 65) = 0.D0
    hmatd(nd, 18, 66) = 0.D0
    hmatd(nd, 19, 66) = -ccyd(nd)
    hmatd(nd, 22, 66) = (((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(1&
&      +cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cbetabar*cgamma/(1+cbetabar*cgamma)**2)*(1-chabb/cgamma)/((clandaw&
&      -1)*curvw+1)+cbetabar*(chabbd(nd)*cgamma-chabb*cgammad(nd))/((1+&
&      cbetabar*cgamma)*cgamma*((clandaw-1)*curvw+1)))/(1-chabb/cgamma)**&
&      2 - ((-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*cprobw/(1+&
&      cbetabar*cgamma)**2)-cprobwd(nd)/(1+cbetabar*cgamma))*(1-chabb/&
&      cgamma)/(cprobw**2*((clandaw-1)*curvw+1))+(chabbd(nd)*cgamma-chabb&
&      *cgammad(nd))/((1+cbetabar*cgamma)*cprobw*((clandaw-1)*curvw+1)*&
&      cgamma**2))/(1-chabb/cgamma)**2 + ((chabbd(nd)*cgamma-chabb*&
&      cgammad(nd))/((1+cbetabar*cgamma)*((clandaw-1)*curvw+1)*cgamma**2)&
&      -(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*(1-chabb/cgamma)/((1+&
&      cbetabar*cgamma)**2*((clandaw-1)*curvw+1)))/(1-chabb/cgamma)**2 - &
&      ((((cprobwd(nd)*cbetabar+cprobw*cbetabard(nd))*cgamma+cprobw*&
&      cbetabar*cgammad(nd))*(1+cbetabar*cgamma)-cprobw*cbetabar*cgamma*(&
&      cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))*(1-chabb/cgamma)/((1+&
&      cbetabar*cgamma)**2*((clandaw-1)*curvw+1))+cprobw*cbetabar*(chabbd&
&      (nd)*cgamma-chabb*cgammad(nd))/(cgamma*(1+cbetabar*cgamma)*((&
&      clandaw-1)*curvw+1)))/(1-chabb/cgamma)**2
    hmatd(nd, 43, 66) = 0.D0
    hmatd(nd, 19, 67) = 0.D0
    hmatd(nd, 20, 67) = 0.D0
    hmatd(nd, 23, 67) = cryd(nd)*crr - cryd(nd) + cry*crrd(nd) - crdyd(&
&      nd)
    hmatd(nd, 42, 67) = 0.D0
    hmatd(nd, 14, 68) = 0.D0
    hmatd(nd, 18, 68) = ((cwhlcd(nd)*csigma-cwhlc*csigmad(nd))*(1+chabb/&
&      cgamma)/csigma**2-cwhlc*(chabbd(nd)*cgamma-chabb*cgammad(nd))/(&
&      csigma*cgamma**2))/(1+chabb/cgamma)**2 - (cwhlcd(nd)*(1+chabb/&
&      cgamma)-cwhlc*(chabbd(nd)*cgamma-chabb*cgammad(nd))/cgamma**2)/(1+&
&      chabb/cgamma)**2
    hmatd(nd, 20, 68) = cfcd(nd)*calfa - cfcd(nd) + cfc*calfad(nd)
    hmatd(nd, 22, 68) = ((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(1+&
&      cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cbetabar*cgamma/(1+cbetabar*cgamma)**2)*csigl/((clandaw-1)*curvw+1&
&      ) - csigld(nd)/((1+cbetabar*cgamma)*cprobw*((clandaw-1)*curvw+1)) &
&      - (-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*cprobw/(1+&
&      cbetabar*cgamma)**2)-cprobwd(nd)/(1+cbetabar*cgamma))*csigl/(&
&      cprobw**2*((clandaw-1)*curvw+1)) + cbetabar*cgamma*csigld(nd)/((1+&
&      cbetabar*cgamma)*((clandaw-1)*curvw+1)) + csigld(nd)/((1+cbetabar*&
&      cgamma)*((clandaw-1)*curvw+1)) - (cbetabard(nd)*cgamma+cbetabar*&
&      cgammad(nd))*csigl/((1+cbetabar*cgamma)**2*((clandaw-1)*curvw+1)) &
&      - (((cprobwd(nd)*cbetabar+cprobw*cbetabard(nd))*cgamma+cprobw*&
&      cbetabar*cgammad(nd))*(1+cbetabar*cgamma)-cprobw*cbetabar*cgamma*(&
&      cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))*csigl/((1+cbetabar*&
&      cgamma)**2*((clandaw-1)*curvw+1)) - cprobw*cbetabar*cgamma*csigld(&
&      nd)/((1+cbetabar*cgamma)*((clandaw-1)*curvw+1))
    hmatd(nd, 48, 68) = 0.D0
    hmatd(nd, 21, 69) = 0.D0
    hmatd(nd, 22, 69) = (-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))/(&
&      1+cbetabar*cgamma)**2 + (((cbetabard(nd)*cgamma+cbetabar*cgammad(&
&      nd))*cindw+cbetabar*cgamma*cindwd(nd))*(1+cbetabar*cgamma)-&
&      cbetabar*cgamma*cindw*(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))&
&      /(1+cbetabar*cgamma)**2
    hmatd(nd, 23, 69) = crpid(nd)*crr - crpid(nd) + crpi*crrd(nd)
    hmatd(nd, 46, 69) = 0.D0
    hmatd(nd, 12, 70) = calfad(nd)
    hmatd(nd, 14, 70) = 0.D0
    hmatd(nd, 22, 70) = (-((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cprobw/(1+cbetabar*cgamma)**2)-cprobwd(nd)/(1+cbetabar*cgamma))/&
&      cprobw**2/((clandaw-1)*curvw+1) - ((cbetabard(nd)*cgamma+cbetabar*&
&      cgammad(nd))/(1+cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*&
&      cgammad(nd))*cbetabar*cgamma/(1+cbetabar*cgamma)**2)/((clandaw-1)*&
&      curvw+1) - (-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd)))/(1+&
&      cbetabar*cgamma)**2/((clandaw-1)*curvw+1) + (((cprobwd(nd)*&
&      cbetabar+cprobw*cbetabard(nd))*cgamma+cprobw*cbetabar*cgammad(nd))&
&      *(1+cbetabar*cgamma)-cprobw*cbetabar*cgamma*(cbetabard(nd)*cgamma+&
&      cbetabar*cgammad(nd)))/(1+cbetabar*cgamma)**2/((clandaw-1)*curvw+1&
&      )
    hmatd(nd, 45, 70) = 0.D0
    hmatd(nd, 17, 71) = 0.D0
    hmatd(nd, 18, 71) = (-(csigmad(nd)*(1+chabb/cgamma)/csigma**2)-(&
&      chabbd(nd)*cgamma-chabb*cgammad(nd))/(csigma*cgamma**2))/(1+chabb/&
&      cgamma)**2 - (((chabbd(nd)*cgamma-chabb*cgammad(nd))*csigma/cgamma&
&      **2-chabb*csigmad(nd)/cgamma)*(1+chabb/cgamma)/csigma**2-chabb*(&
&      chabbd(nd)*cgamma-chabb*cgammad(nd))/(cgamma**3*csigma))/(1+chabb/&
&      cgamma)**2
    hmatd(nd, 23, 71) = 0.D0
    hmatd(nd, 47, 71) = 0.D0
    hmatd(nd, 1, 72) = 0.D0
    hmatd(nd, 9, 72) = -cfcd(nd)
    hmatd(nd, 12, 72) = 0.D0
    hmatd(nd, 20, 72) = -cfcd(nd)
    hmatd(nd, 24, 72) = 0.D0
    hmatd(nd, 6, 73) = -((chabbd(nd)*cgamma-chabb*cgammad(nd))*csigma*(1&
&      +chabb/cgamma)/(cgamma**2*(1-chabb/cgamma)**2)+(csigmad(nd)*(1+&
&      chabb/cgamma)+csigma*(chabbd(nd)*cgamma-chabb*cgammad(nd))/cgamma&
&      **2)/(1-chabb/cgamma))
    hmatd(nd, 7, 73) = 0.D0
    hmatd(nd, 17, 73) = -((chabbd(nd)*cgamma-chabb*cgammad(nd))*csigma*(&
&      1+chabb/cgamma)/(cgamma**2*(1-chabb/cgamma)**2)+(csigmad(nd)*(1+&
&      chabb/cgamma)+csigma*(chabbd(nd)*cgamma-chabb*cgammad(nd))/cgamma&
&      **2)/(1-chabb/cgamma))
    hmatd(nd, 18, 73) = 0.D0
    hmatd(nd, 25, 73) = 0.D0
    hmatd(nd, 8, 74) = 0.D0
    hmatd(nd, 19, 74) = 0.D0
    hmatd(nd, 26, 74) = 0.D0
    hmatd(nd, 5, 75) = 0.D0
    hmatd(nd, 11, 75) = -((cikbard(nd)*csadjcost+cikbar*csadjcostd(nd))*&
&      cgamma**2+cikbar*csadjcost*2*cgamma*cgammad(nd))
    hmatd(nd, 16, 75) = 0.D0
    hmatd(nd, 27, 75) = 0.D0
    hmatd(nd, 40, 75) = -((cikbard(nd)*csadjcost+cikbar*csadjcostd(nd))*&
&      cgamma**2+cikbar*csadjcost*2*cgamma*cgammad(nd))
    hmatd(nd, 23, 76) = 0.D0
    hmatd(nd, 28, 76) = 0.D0
    hmatd(nd, 21, 77) = 0.D0
    hmatd(nd, 29, 77) = 0.D0
    hmatd(nd, 29, 78) = 0.D0
    hmatd(nd, 30, 78) = 0.D0
    hmatd(nd, 22, 79) = 0.D0
    hmatd(nd, 31, 79) = 0.D0
    hmatd(nd, 31, 80) = 0.D0
    hmatd(nd, 32, 80) = 0.D0
    hmatd(nd, 33, 81) = 0.D0
    hmatd(nd, 34, 82) = 0.D0
    hmatd(nd, 35, 83) = 0.D0
    hmatd(nd, 36, 84) = 0.D0
    hmatd(nd, 37, 85) = 0.D0
    hmatd(nd, 38, 86) = 0.D0
    hmatd(nd, 39, 87) = 0.D0
    hmatd(nd, 40, 88) = 0.D0
    hmatd(nd, 41, 89) = 0.D0
    hmatd(nd, 42, 89) = -ctrendd(nd)
    hmatd(nd, 43, 89) = -ctrendd(nd)
    hmatd(nd, 44, 89) = -ctrendd(nd)
    hmatd(nd, 45, 89) = -ctrendd(nd)
    hmatd(nd, 46, 89) = -constepinfd(nd)
  END DO
  pwx1 = 1 + ctrend/100
  pwr1 = pwx1**csigma
  pwx2 = 1 + ctrend/100
  pwr2 = pwx2**csigma
  pwr3 = calfa**calfa
  pwx4 = 1 - calfa
  pwy4 = 1 - calfa
  pwr4 = pwx4**pwy4
  pwx5 = 1 + ctrend/100
  pwr5 = pwx5**csigma
  pwx6 = (1+constebeta/100)*pwr5 - 39.d0/40.d0
  pwr6 = pwx6**calfa
  pwx7 = pwr3*pwr4/cfc/pwr6
  pwy7 = 1/(1-calfa)
  pwr7 = pwx7**pwy7
  pwx8 = (1-calfa)/calfa*((1+constebeta/100)*pwr2-39.d0/40.d0)/pwr7
  pwy8 = -1 + calfa
  pwr8 = pwx8**pwy8
  cwly = 1 - ((1+constebeta/100)*pwr1-39.d0/40.d0)*cfc*pwr8
  pwx1 = 1 + ctrend/100
  pwy1 = -csigma
  pwr1 = pwx1**pwy1
  DO nd=1,nbdirs
    IF (pwx1 .GT. 0.0) THEN
      pwr1d(nd) = pwx1**pwy1*(LOG(pwx1)*pwy1d(nd)+pwy1*pwx1d(nd)/pwx1)
    ELSE IF (pwx1 .EQ. 0.0) THEN
      IF (pwy1 .EQ. 1.0) THEN
        pwr1d(nd) = pwx1d(nd)
      ELSE
        pwr1d(nd) = 0.0
      END IF
    ELSE IF (pwy1 .EQ. INT(pwy1)) THEN
      pwr1d(nd) = pwy1*pwx1**(pwy1-1)*pwx1d(nd)
    ELSE
      pwr1d(nd) = 0.0
    END IF
    consterd(nd) = (100*(constepinfd(nd)*(1+constebeta/100)/100+(1+&
&      constepinf/100)*constebetad(nd)/100)*pwr1-100*(1+constepinf/100)*(&
&      1+constebeta/100)*pwr1d(nd))/pwr1**2
    hmatd(nd, 47, 89) = -consterd(nd)
    hmatd(nd, 48, 89) = -constelabd(nd)
    hmatd(nd, 42, 90) = 0.D0
    hmatd(nd, 43, 91) = 0.D0
    hmatd(nd, 44, 92) = 0.D0
    hmatd(nd, 45, 93) = 0.D0
    hmatd(nd, 46, 94) = 0.D0
    hmatd(nd, 47, 95) = 0.D0
    hmatd(nd, 48, 96) = 0.D0
    hmatd(nd, 6, 99) = -((crkd(nd)*(crk+1-ctou)-crk*crkd(nd))/(crk+1-&
&      ctou)**2)
    hmatd(nd, 5, 101) = -((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(1&
&      +cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cbetabar*cgamma/(1+cbetabar*cgamma)**2)
    hmatd(nd, 6, 102) = -((-crkd(nd))/(crk+1-ctou)**2) - ctou*crkd(nd)/(&
&      crk+1-ctou)**2
    hmatd(nd, 7, 103) = -((-((chabbd(nd)*cgamma-chabb*cgammad(nd))/&
&      cgamma**2))/(1+chabb/cgamma)**2)
    hmatd(nd, 7, 105) = (cwhlcd(nd)*(1+chabb/cgamma)-cwhlc*(chabbd(nd)*&
&      cgamma-chabb*cgammad(nd))/cgamma**2)/(1+chabb/cgamma)**2 - ((&
&      cwhlcd(nd)*csigma-cwhlc*csigmad(nd))*(1+chabb/cgamma)/csigma**2-&
&      cwhlc*(chabbd(nd)*cgamma-chabb*cgammad(nd))/(csigma*cgamma**2))/(1&
&      +chabb/cgamma)**2
    hmatd(nd, 17, 110) = -((crkd(nd)*(crk+1-ctou)-crk*crkd(nd))/(crk+1-&
&      ctou)**2)
    hmatd(nd, 16, 112) = -((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(&
&      1+cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cbetabar*cgamma/(1+cbetabar*cgamma)**2)
    hmatd(nd, 17, 113) = -((-crkd(nd))/(crk+1-ctou)**2) - ctou*crkd(nd)/&
&      (crk+1-ctou)**2
    hmatd(nd, 18, 114) = -((-((chabbd(nd)*cgamma-chabb*cgammad(nd))/&
&      cgamma**2))/(1+chabb/cgamma)**2)
    hmatd(nd, 18, 116) = (cwhlcd(nd)*(1+chabb/cgamma)-cwhlc*(chabbd(nd)*&
&      cgamma-chabb*cgammad(nd))/cgamma**2)/(1+chabb/cgamma)**2 - ((&
&      cwhlcd(nd)*csigma-cwhlc*csigmad(nd))*(1+chabb/cgamma)/csigma**2-&
&      cwhlc*(chabbd(nd)*cgamma-chabb*cgammad(nd))/(csigma*cgamma**2))/(1&
&      +chabb/cgamma)**2
    hmatd(nd, 17, 117) = 0.D0
    hmatd(nd, 18, 117) = (((chabbd(nd)*cgamma-chabb*cgammad(nd))*csigma/&
&      cgamma**2-chabb*csigmad(nd)/cgamma)*(1+chabb/cgamma)/csigma**2-&
&      chabb*(chabbd(nd)*cgamma-chabb*cgammad(nd))/(cgamma**3*csigma))/(1&
&      +chabb/cgamma)**2 - (-(csigmad(nd)*(1+chabb/cgamma)/csigma**2)-(&
&      chabbd(nd)*cgamma-chabb*cgammad(nd))/(csigma*cgamma**2))/(1+chabb/&
&      cgamma)**2
    hmatd(nd, 21, 117) = -((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(&
&      1+cbetabar*cgamma*cindp)-((cbetabard(nd)*cgamma+cbetabar*cgammad(&
&      nd))*cindp+cbetabar*cgamma*cindpd(nd))*cbetabar*cgamma/(1+cbetabar&
&      *cgamma*cindp)**2)
    hmatd(nd, 22, 117) = -((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(&
&      1+cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cbetabar*cgamma/(1+cbetabar*cgamma)**2)
    hmatd(nd, 22, 118) = -((cbetabard(nd)*cgamma+cbetabar*cgammad(nd))/(&
&      1+cbetabar*cgamma)-(cbetabard(nd)*cgamma+cbetabar*cgammad(nd))*&
&      cbetabar*cgamma/(1+cbetabar*cgamma)**2)
  END DO
  conster = 100*(1+constepinf/100)*(1+constebeta/100)/pwr1 - 100
!
! Assign Hmat
!
  hmat(:, :) = 0.0d0
  hmat(5, 5) = -(1/(1+cbetabar*cgamma))
  hmat(7, 7) = -(chabb/cgamma/(1+chabb/cgamma))
  hmat(10, 7) = chabb/cgamma/(1-chabb/cgamma)
  hmat(23, 8) = -crdy
  hmat(4, 11) = -1.0000000000000000d0
  hmat(11, 11) = -1 + cikbar
  hmat(16, 16) = -(1/(1+cbetabar*cgamma))
  hmat(44, 16) = 1.0000000000000000d0
  hmat(18, 18) = -(chabb/cgamma/(1+chabb/cgamma))
  hmat(22, 18) = 1/(1+cbetabar*cgamma)/cprobw/((clandaw-1)*curvw+1)*&
&    chabb/cgamma/(1-chabb/cgamma) - 1/(1+cbetabar*cgamma)*cbetabar/((&
&    clandaw-1)*curvw+1)*chabb/(1-chabb/cgamma) - 1/(1+cbetabar*cgamma)/(&
&    (clandaw-1)*curvw+1)*chabb/cgamma/(1-chabb/cgamma) + cprobw*cbetabar&
&    /(1+cbetabar*cgamma)/((clandaw-1)*curvw+1)*chabb/(1-chabb/cgamma)
  hmat(43, 18) = 1.0000000000000000d0
  hmat(23, 19) = crdy
  hmat(42, 19) = 1.0000000000000000d0
  hmat(21, 21) = -(1/(1+cbetabar*cgamma*cindp)*cindp)
  hmat(22, 21) = -(cindw/(1+cbetabar*cgamma))
  hmat(22, 22) = -(1/(1+cbetabar*cgamma))
  hmat(45, 22) = 1.0000000000000000d0
  hmat(23, 23) = -crr
  hmat(24, 24) = -crhoa
  hmat(25, 25) = -crhob
  hmat(26, 26) = -crhog
  hmat(27, 27) = -crhoqs
  hmat(28, 28) = -crhoms
  hmat(29, 29) = -crhopinf
  hmat(29, 30) = cmap
  hmat(31, 31) = -crhow
  hmat(31, 32) = cmaw
  hmat(24, 33) = -std_ea
  hmat(26, 33) = -(cgy*std_ea)
  hmat(25, 34) = -std_eb
  hmat(26, 35) = -std_eg
  hmat(27, 36) = -std_eqs
  hmat(28, 37) = -std_em
  hmat(30, 38) = -std_epinf
  hmat(32, 39) = -std_ew
  hmat(15, 40) = -1.0000000000000000d0
  hmat(40, 40) = -1 + cikbar
  hmat(41, 41) = -0.99999900000000d0
  hmat(6, 49) = 1.0000000000000000d0
  hmat(7, 49) = 1/csigma/(1+chabb/cgamma) - chabb/cgamma/csigma/(1+chabb&
&    /cgamma)
  hmat(2, 50) = 1.0000000000000000d0
  hmat(4, 50) = -1.0000000000000000d0
  hmat(8, 50) = -crkky
  hmat(1, 51) = -calfa
  hmat(2, 51) = -(1/czcap*(1-czcap))
  hmat(3, 51) = 1.0000000000000000d0
  hmat(3, 52) = 1.0000000000000000d0
  hmat(4, 52) = 1.0000000000000000d0
  hmat(9, 52) = -(cfc*calfa)
  hmat(5, 53) = 1.0000000000000000d0
  hmat(8, 53) = -ciy
  hmat(11, 53) = -cikbar
  hmat(5, 54) = -(1/(1+cbetabar*cgamma)/cgamma**2/csadjcost)
  hmat(6, 54) = 1.0000000000000000d0
  hmat(7, 55) = 1.0000000000000000d0
  hmat(8, 55) = -ccy
  hmat(10, 55) = -(1/(1-chabb/cgamma))
  hmat(8, 56) = 1.0000000000000000d0
  hmat(9, 56) = 1.0000000000000000d0
  hmat(23, 56) = cry - cry*crr + crdy
  hmat(3, 57) = -1.0000000000000000d0
  hmat(7, 57) = -(cwhlc/(1+chabb/cgamma)) + cwhlc/csigma/(1+chabb/cgamma&
&    )
  hmat(9, 57) = -cfc + cfc*calfa
  hmat(10, 57) = -csigl
  hmat(1, 58) = -1 + calfa
  hmat(3, 58) = -1.0000000000000000d0
  hmat(10, 58) = 1.0000000000000000d0
  hmat(11, 59) = 1.0000000000000000d0
  hmat(12, 60) = 1.0000000000000000d0
  hmat(21, 60) = -(1/(1+cbetabar*cgamma*cindp)/cprobp/((cfc-1)*curvp+1))&
&    + 1/(1+cbetabar*cgamma*cindp)*cbetabar*cgamma/((cfc-1)*curvp+1) + 1/&
&    (1+cbetabar*cgamma*cindp)/((cfc-1)*curvp+1) - 1/(1+cbetabar*cgamma*&
&    cindp)*cbetabar*cgamma*cprobp/((cfc-1)*curvp+1)
  hmat(13, 61) = 1.0000000000000000d0
  hmat(15, 61) = -1.0000000000000000d0
  hmat(19, 61) = -crkky
  hmat(12, 62) = -calfa
  hmat(13, 62) = -(1/czcap*(1-czcap))
  hmat(14, 62) = 1.0000000000000000d0
  hmat(14, 63) = 1.0000000000000000d0
  hmat(15, 63) = 1.0000000000000000d0
  hmat(20, 63) = -(cfc*calfa)
  hmat(16, 64) = 1.0000000000000000d0
  hmat(19, 64) = -ciy
  hmat(40, 64) = -cikbar
  hmat(44, 64) = -1.0000000000000000d0
  hmat(16, 65) = -(1/(1+cbetabar*cgamma)/cgamma**2/csadjcost)
  hmat(17, 65) = 1.0000000000000000d0
  hmat(18, 66) = 1.0000000000000000d0
  hmat(19, 66) = -ccy
  hmat(22, 66) = -(1/(1+cbetabar*cgamma)/cprobw/((clandaw-1)*curvw+1)/(1&
&    -chabb/cgamma)) + 1/(1+cbetabar*cgamma)*cbetabar*cgamma/((clandaw-1)&
&    *curvw+1)/(1-chabb/cgamma) + 1/(1+cbetabar*cgamma)/((clandaw-1)*&
&    curvw+1)/(1-chabb/cgamma) - cprobw*cbetabar*cgamma/(1+cbetabar*&
&    cgamma)/((clandaw-1)*curvw+1)/(1-chabb/cgamma)
  hmat(43, 66) = -1.0000000000000000d0
  hmat(19, 67) = 1.0000000000000000d0
  hmat(20, 67) = 1.0000000000000000d0
  hmat(23, 67) = -cry + cry*crr - crdy
  hmat(42, 67) = -1.0000000000000000d0
  hmat(14, 68) = -1.0000000000000000d0
  hmat(18, 68) = -(cwhlc/(1+chabb/cgamma)) + cwhlc/csigma/(1+chabb/&
&    cgamma)
  hmat(20, 68) = -cfc + cfc*calfa
  hmat(22, 68) = -(1/(1+cbetabar*cgamma)/cprobw/((clandaw-1)*curvw+1)*&
&    csigl) + 1/(1+cbetabar*cgamma)*cbetabar*cgamma/((clandaw-1)*curvw+1)&
&    *csigl + 1/(1+cbetabar*cgamma)/((clandaw-1)*curvw+1)*csigl - cprobw*&
&    cbetabar*cgamma/(1+cbetabar*cgamma)/((clandaw-1)*curvw+1)*csigl
  hmat(48, 68) = -1.0000000000000000d0
  hmat(21, 69) = 1.0000000000000000d0
  hmat(22, 69) = 1/(1+cbetabar*cgamma) + cbetabar*cgamma*cindw/(1+&
&    cbetabar*cgamma)
  hmat(23, 69) = -crpi + crpi*crr
  hmat(46, 69) = -1.0000000000000000d0
  hmat(12, 70) = -1 + calfa
  hmat(14, 70) = -1.0000000000000000d0
  hmat(22, 70) = 1 + 1/(1+cbetabar*cgamma)/cprobw/((clandaw-1)*curvw+1) &
&    - 1/(1+cbetabar*cgamma)*cbetabar*cgamma/((clandaw-1)*curvw+1) - 1/(1&
&    +cbetabar*cgamma)/((clandaw-1)*curvw+1) + cprobw*cbetabar*cgamma/(1+&
&    cbetabar*cgamma)/((clandaw-1)*curvw+1)
  hmat(45, 70) = -1.0000000000000000d0
  hmat(17, 71) = 1.0000000000000000d0
  hmat(18, 71) = 1/csigma/(1+chabb/cgamma) - chabb/cgamma/csigma/(1+&
&    chabb/cgamma)
  hmat(23, 71) = 1.0000000000000000d0
  hmat(47, 71) = -1.0000000000000000d0
  hmat(1, 72) = 1.0000000000000000d0
  hmat(9, 72) = -cfc
  hmat(12, 72) = 1.0000000000000000d0
  hmat(20, 72) = -cfc
  hmat(24, 72) = 1.0000000000000000d0
  hmat(6, 73) = -(1/(1-chabb/cgamma)*csigma*(1+chabb/cgamma))
  hmat(7, 73) = -1.0000000000000000d0
  hmat(17, 73) = -(1/(1-chabb/cgamma)*csigma*(1+chabb/cgamma))
  hmat(18, 73) = -1.0000000000000000d0
  hmat(25, 73) = 1.0000000000000000d0
  hmat(8, 74) = -1.0000000000000000d0
  hmat(19, 74) = -1.0000000000000000d0
  hmat(26, 74) = 1.0000000000000000d0
  hmat(5, 75) = -1.0000000000000000d0
  hmat(11, 75) = -(cikbar*cgamma**2*csadjcost)
  hmat(16, 75) = -1.0000000000000000d0
  hmat(27, 75) = 1.0000000000000000d0
  hmat(40, 75) = -(cikbar*cgamma**2*csadjcost)
  hmat(23, 76) = -1.0000000000000000d0
  hmat(28, 76) = 1.0000000000000000d0
  hmat(21, 77) = -1.0000000000000000d0
  hmat(29, 77) = 1.0000000000000000d0
  hmat(29, 78) = -1.0000000000000000d0
  hmat(30, 78) = 1.0000000000000000d0
  hmat(22, 79) = -1.0000000000000000d0
  hmat(31, 79) = 1.0000000000000000d0
  hmat(31, 80) = -1.0000000000000000d0
  hmat(32, 80) = 1.0000000000000000d0
  hmat(33, 81) = 1.0000000000000000d0
  hmat(34, 82) = 1.0000000000000000d0
  hmat(35, 83) = 1.0000000000000000d0
  hmat(36, 84) = 1.0000000000000000d0
  hmat(37, 85) = 1.0000000000000000d0
  hmat(38, 86) = 1.0000000000000000d0
  hmat(39, 87) = 1.0000000000000000d0
  hmat(40, 88) = 1.0000000000000000d0
  hmat(41, 89) = 1.0000000000000000d0
  hmat(42, 89) = -ctrend
  hmat(43, 89) = -ctrend
  hmat(44, 89) = -ctrend
  hmat(45, 89) = -ctrend
  hmat(46, 89) = -constepinf
  hmat(47, 89) = -conster
  hmat(48, 89) = -constelab
  hmat(42, 90) = 1.0000000000000000d0
  hmat(43, 91) = 1.0000000000000000d0
  hmat(44, 92) = 1.0000000000000000d0
  hmat(45, 93) = 1.0000000000000000d0
  hmat(46, 94) = 1.0000000000000000d0
  hmat(47, 95) = 1.0000000000000000d0
  hmat(48, 96) = 1.0000000000000000d0
  hmat(6, 99) = -(crk/(crk+1-ctou))
  hmat(5, 101) = -(1/(1+cbetabar*cgamma)*cbetabar*cgamma)
  hmat(6, 102) = -(1/(crk+1-ctou)) + ctou/(crk+1-ctou)
  hmat(7, 103) = -(1/(1+chabb/cgamma))
  hmat(7, 105) = cwhlc/(1+chabb/cgamma) - cwhlc/csigma/(1+chabb/cgamma)
  hmat(17, 110) = -(crk/(crk+1-ctou))
  hmat(16, 112) = -(1/(1+cbetabar*cgamma)*cbetabar*cgamma)
  hmat(17, 113) = -(1/(crk+1-ctou)) + ctou/(crk+1-ctou)
  hmat(18, 114) = -(1/(1+chabb/cgamma))
  hmat(18, 116) = cwhlc/(1+chabb/cgamma) - cwhlc/csigma/(1+chabb/cgamma)
  hmat(17, 117) = -1.0000000000000000d0
  hmat(18, 117) = -(1/csigma/(1+chabb/cgamma)) + chabb/cgamma/csigma/(1+&
&    chabb/cgamma)
  hmat(21, 117) = -(1/(1+cbetabar*cgamma*cindp)*cbetabar*cgamma)
  hmat(22, 117) = -(1/(1+cbetabar*cgamma)*cbetabar*cgamma)
  hmat(22, 118) = -(1/(1+cbetabar*cgamma)*cbetabar*cgamma)
END SUBROUTINE GET_HMAT_DV
